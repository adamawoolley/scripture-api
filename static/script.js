dummyData = {English: {intro: 'The commandments of Alma to his son Shiblon.', comprising: 'Comprising chapter\xa038.', summary: 'Shiblon was persecuted for righteousness’ sake—Salvation is in Christ, who is the life and the light of the world—Bridle all your passions. About 74\xa0B.C.', verses: ['My son, give ear to my words, for I say unto you, even as I said unto Helaman, that inasmuch as ye shall keep the commandments of God ye shall prosper in the land; and inasmuch as ye will not keep the commandments of God ye shall be cut off from his presence.', 'And now, my son, I trust that I shall have great joy in you, because of your steadiness and your faithfulness unto God; for as you have commenced in your youth to look to the Lord your God, even so I hope that you will continue in keeping his commandments; for blessed is he that endureth to the end.', 'I say unto you, my son, that I have had great joy in thee already, because of thy faithfulness and thy diligence, and thy patience and thy long-suffering among the people of the Zoramites.', 'For I know that thou wast in bonds; yea, and I also know that thou wast stoned for the word’s sake; and thou didst bear all these things with patience because the Lord was with thee; and now thou knowest that the Lord did deliver thee.', 'And now my son, Shiblon, I would that ye should remember, that as much as ye shall put your trust in God even so much ye shall be delivered out of your trials, and your troubles, and your afflictions, and ye shall be lifted up at the last day.', 'Now, my son, I would not that ye should think that I know these things of myself, but it is the Spirit of God which is in me which maketh these things known unto me; for if I had not been born of God I should not have known these things.', 'But behold, the Lord in his great mercy sent his angel to declare unto me that I must stop the work of destruction among his people; yea, and I have seen an angel face to face, and he spake with me, and his voice was as thunder, and it shook the whole earth.', 'And it came to pass that I was three days and three nights in the most bitter pain and anguish of soul; and never, until I did cry out unto the Lord Jesus Christ for mercy, did I receive a remission of my sins. But behold, I did cry unto him and I did find peace to my soul.', 'And now, my son, I have told you this that ye may learn wisdom, that ye may learn of me that there is no other way or means whereby man can be saved, only in and through Christ. Behold, he is the life and the light of the world. Behold, he is the word of truth and righteousness.', 'And now, as ye have begun to teach the word even so I would that ye should continue to teach; and I would that ye would be diligent and temperate in all things.', 'See that ye are not lifted up unto pride; yea, see that ye do not boast in your own wisdom, nor of your much strength.', 'Use boldness, but not overbearance; and also see that ye bridle all your passions, that ye may be filled with love; see that ye refrain from idleness.', 'Do not pray as the Zoramites do, for ye have seen that they pray to be heard of men, and to be praised for their wisdom.', 'Do not say: O God, I thank thee that we are better than our brethren; but rather say: O Lord, forgive my unworthiness, and remember my brethren in mercy—yea, acknowledge your unworthiness before God at all times.', 'And may the Lord bless your soul, and receive you at the last day into his kingdom, to sit down in peace. Now go, my son, and teach the word unto this people. Be sober. My son, farewell.']}, French: {intro: 'Commandements d’Alma à son fils Shiblon.', comprising: 'Chapitre\xa038.', summary: 'Shiblon était persécuté à cause de la justice\xa0— Le salut est dans le Christ, qui est la vie et la lumière du monde\xa0— Tenez toutes vos passions en bride. Vers 74\xa0av.\xa0J.-C.', verses: ['Mon fils, prête l’oreille à mes paroles, car je te dis, comme j’ai dit à Hélaman, que si tu gardes les commandements de Dieu, tu prospéreras dans le pays\xa0; et si tu ne gardes pas les commandements de Dieu, tu seras retranché de sa présence.', 'Et maintenant, mon fils, j’ai l’assurance que tu seras pour moi une grande joie, à cause de ta stabilité et de ta fidélité à Dieu\xa0; car de même que tu as commencé dans ta jeunesse à regarder vers le Seigneur, ton Dieu, de même j’espère que tu continueras à garder ses commandements\xa0; car béni est celui qui persévère jusqu’à la fin.', 'Je te dis, mon fils, que tu as déjà été une grande joie pour moi à cause de ta fidélité, et de ta diligence, et de ta patience, et de ta longanimité parmi le peuple des Zoramites.', 'Car je sais que tu as été dans les liens\xa0; oui, et je sais aussi que tu as été lapidé pour l’amour de la parole\xa0; et tu as supporté tout cela avec patience, parce que le Seigneur était avec toi\xa0; et maintenant tu sais que le Seigneur t’a délivré.', 'Et maintenant, mon fils Shiblon, je voudrais que tu te souviennes que dans la mesure où tu placeras ta confiance en Dieu, dans cette même mesure tu seras délivré de tes épreuves, et de tes difficultés, et de tes afflictions, et tu seras élevé au dernier jour.', 'Or, mon fils, je ne voudrais pas que tu penses que je connais ces choses par moi-même, mais c’est l’Esprit de Dieu, qui est en moi, qui me fait connaître ces choses\xa0; car si je n’étais pas né de Dieu, je n’aurais pas connu ces choses.', 'Mais voici, le Seigneur, dans sa grande miséricorde, a envoyé son ange m’annoncer que je devais arrêter l’œuvre de destruction parmi son peuple\xa0; oui, et j’ai vu un ange face à face, et il a parlé avec moi, et sa voix était comme le tonnerre, et elle a fait trembler la terre tout entière.', 'Et il arriva que je fus trois jours et trois nuits l’âme remplie des souffrances et des angoisses les plus cruelles\xa0; et ce ne fut que lorsque je criai au Seigneur Jésus-Christ pour implorer miséricorde que je reçus le pardon de mes péchés. Mais voici, je criai vers lui et je trouvai la paix pour mon âme.', 'Et maintenant, mon fils, je t’ai dit cela afin que tu apprennes la sagesse, afin que tu apprennes de moi qu’il n’y a pas d’autre chemin ni de moyen par lequel l’homme puisse être sauvé, si ce n’est dans et par l’intermédiaire du Christ. Voici, il est la vie et la lumière du monde. Voici, il est la parole de vérité et de justice.', 'Et maintenant, comme tu as commencé à enseigner la parole, de même je voudrais que tu continues à enseigner\xa0; et je voudrais que tu sois diligent et modéré en tout.', 'Veille à ne pas être enflé dans l’orgueil\xa0; oui, veille à ne pas te vanter de ta sagesse ni de ta grande force.', 'Use de hardiesse, mais pas d’arrogance\xa0; et veille aussi à tenir toutes tes passions en bride, afin d’être rempli d’amour\xa0; veille à t’abstenir de l’oisiveté.', 'Ne prie pas comme font les Zoramites, car tu as vu qu’ils prient pour être entendus des hommes et pour être loués pour leur sagesse.', 'Ne dis pas\xa0: Ô Dieu, je te remercie de ce que nous sommes meilleurs que nos frères\xa0; mais dis plutôt\xa0: Ô Seigneur, pardonne mon indignité, et souviens-toi de mes frères avec miséricorde\xa0— oui, reconnais en tout temps ton indignité devant Dieu.', 'Et que le Seigneur bénisse ton âme et te reçoive au dernier jour dans son royaume, pour t’asseoir en paix. Or, va, mon fils, et enseigne la parole à ce peuple. Sois sérieux. Mon fils, adieu.']}, Portuguese:{intro: 'Os mandamentos de Alma a seu filho Siblon.', comprising: 'Abrangem o capítulo\xa038.', summary: 'Siblon foi perseguido por causa da retidão\xa0— A salvação está em Cristo, que é a vida e a luz do mundo\xa0— Refreai todas as vossas paixões. Aproximadamente 74\xa0a.C.', verses: ['Meu filho, ouve minhas palavras, pois digo-te, como disse a Helamã, que, se guardares os mandamentos de Deus, prosperarás na terra; e se não guardares os mandamentos de Deus, serás afastado de sua presença.', 'E agora, meu filho, confio em que terei grande alegria em ti, devido a tua constância e fidelidade a Deus; porque assim como principiaste em tua juventude a confiar no Senhor teu Deus, da mesma forma espero que continues a guardar seus mandamentos; porque bem-aventurado é o que persevera até o fim.', 'Digo-te, meu filho, que eu já tive grande satisfação por tua causa, devido a tua fidelidade e tua diligência e tua paciência e tua longanimidade quando com os zoramitas.', 'Porque sei que estiveste preso; sim, sei também que foste apedrejado por causa da palavra; e suportaste todas estas coisas com paciência, porque o Senhor estava contigo; e agora sabes que o Senhor te livrou.', 'E agora, meu filho Siblon, quisera que te lembrasses de que, se puseres a tua confiança em Deus, serás libertado de tuas provações e teus dissabores e tuas aflições; e serás elevado no último dia.', 'Ora, meu filho, eu não quero que julgues que sei estas coisas por mim mesmo; mas é o Espírito de Deus que está em mim que me dá a conhecer estas coisas; pois se eu não tivesse nascido de Deus, não saberia estas coisas.', 'Mas eis que o Senhor, em sua grande misericórdia, enviou seu anjo a fim de declarar-me que eu deveria cessar a obra de destruição entre seu povo; sim, e vi um anjo face a face e ele falou comigo; e a sua voz era como um trovão, e abalou a terra toda.', 'E aconteceu que eu passei três dias e três noites na mais amarga dor e angústia; e não obtive a remissão de meus pecados até rogar por misericórdia ao Senhor Jesus Cristo. Mas eis que clamei a ele e achei paz para minha alma.', 'E agora, meu filho, disse-te isto para que adquiras sabedoria, para que aprendas de mim que não há outro caminho ou meio pelo qual o homem possa ser salvo, a não ser em Cristo e por intermédio dele. Eis que ele é a vida e a luz do mundo. Eis que ele é a palavra da verdade e da retidão.', 'E agora, como começaste a ensinar a palavra, assim desejo que continues a ensinar. E desejo que sejas diligente e moderado em todas as coisas.', 'Procura não ser orgulhoso; sim, procura não te vangloriares da tua própria sabedoria nem de tua grande força.', 'Usa de ousadia, mas não de despotismo; faze também com que todas as tuas paixões sejam dominadas, para que te enchas de amor; procura fugir da ociosidade.', 'Não ores como o fazem os zoramitas, pois viste que eles oram para serem ouvidos pelos homens e para serem louvados por sua sabedoria.', 'Não digas: Ó Deus, agradeço-te por sermos melhores que nossos irmãos; mas antes, dize: Ó Senhor, perdoa minha indignidade e lembra de meus irmãos com misericórdia! Sim, reconhece a tua indignidade perante Deus em todos os momentos.', 'E que o Senhor abençoe tua alma e te receba no último dia em seu reino, para assentares-te em paz. Vai agora, meu filho, e ensina a palavra a este povo. Sê moderado. Adeus, meu filho.']}}

function titleCase(string) {
	 var sentence = string.toLowerCase().split(" ");
	 for(var i = 0; i< sentence.length; i++){
			sentence[i] = sentence[i][0].toUpperCase() + sentence[i].slice(1);
	 }
	 return sentence.join(' ');
}

async function queryAPI(url) {
		let response = await fetch(url);

		if (response.status == 200) {
				let json = await response.json();
				return json;
		}
		console.log('Error', response.status)
		return 'error'
}

var app = new Vue({
	el: "#app",
  delimiters: ['[[',']]'],
	data: {
		vertical: true,
		langs: [
			{ name: "English", short: "eng", chapter: dummyData.English},
			{ name: "Portuguese", short: "por", chapter: dummyData.Portuguese },
			{ name: "French", short: "fra", chapter: dummyData.French },
		],
		chapter: "Alma 38",
        newChapter: "",
        books: {
            "1-nephi": 22,
						"2-nephi": 33,
						"jacob": 7,
						"enos": 1,
						"jarom": 1,
						"omni": 1,
						"words-of-mormon": 1,
						"mosiah": 29,
						"alma": 63,
						"helaman": 16,
						"3-nephi": 30,
						"4-nephi": 1,
						"mormon": 9,
						"ether": 15,
					   "moroni": 10
        },
        apiURL: '/api/'
	},
        methods: {
        fetchChapter: function() {
            chapter = this.newChapter.toLowerCase().trim().split(/\s+/)

            // Check to see if valid input
            if (
                // chapter number is a number
                !isNaN(chapter[chapter.length-1]) &&

                // the book is a valid book
                this.books.hasOwnProperty(chapter.slice(0, chapter.length - 1).join('-')) &&

                // Make sure the chapter number is postive
                Math.sign(parseInt(chapter[chapter.length - 1])) > 0 &&

                // the chapter is part of the book
                this.books[chapter.slice(0, chapter.length - 1).join('-')] >= parseInt(chapter[chapter.length - 1])
            ) {

                let requestURL = this.apiURL + chapter.slice(0, chapter.length - 1).join('-') + '/' + chapter[chapter.length - 1] + '?langs='

                for (lang in this.langs) {
                     requestURL += this.langs[lang].short + '+'
                }

								queryAPI(requestURL).then(data => app.langs = data)//.then(function(response) {console.log(response);return response})

								this.chapter = chapter.join(' ')
								this.newChapter = ''

            } else {
                console.log('this is not a valid input!')
            }

        }
    }
})
